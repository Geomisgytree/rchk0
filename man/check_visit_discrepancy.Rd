% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_visit_discrepancy.R
\name{check_visit_discrepancy}
\alias{check_visit_discrepancy}
\title{Check visit discrepancies across EX/EC, SV, and TRTDSPN}
\usage{
check_visit_discrepancy(
  datasets_pool,
  wb,
  seq = NULL,
  output_tab = NULL,
  visit_info_df = NULL,
  visit_excl = c(1, 28, 801, 802, 803)
)
}
\arguments{
\item{datasets_pool}{Named list of raw datasets}

\item{wb}{An openxlsx Workbook object}

\item{seq}{Integer. If 1, run missing visits check; if 2, run date mismatch check.}

\item{output_tab}{Name of Excel worksheet to create}

\item{visit_info_df}{Metadata with dataset, visit_label_col, visit_date_col}

\item{visit_excl}{Numeric vector of VISIDs to exclude (default: \code{c(1,28,801,802,803)})}
}
\value{
Writes a worksheet with detected issues into \code{wb}
}
\description{
This function compares visits across \code{ec1001} (or EX), \code{sv1001},
and \code{trtdspn} datasets by VISID, to identify:
\enumerate{
\item Missing visit records in one or more datasets
\item Visit date mismatches between TRTDSPN and EX/SV
}
}
